@base = http://localhost:3000
@json = application/json
@q = test            # ê²€ìƒ‰ì–´ ê¸°ë³¸ê°’ (ì›í•˜ë©´ ë°”ê¿”ì„œ ì‚¬ìš©)
@other = 42          # DM ëŒ€ìƒ userId (ê²€ìƒ‰ ê²°ê³¼ ë³´ê³  ìˆ˜ì •)

### 0) ë¡œê·¸ì¸ (access/refresh í™•ë³´)
# @name login
POST {{base}}/auth/login
Content-Type: {{json}}

{
  "usernameOrEmail": "dummy2",
  "password": "pass1234"
}

### 1) refreshë¡œ ìƒˆ access ë°›ê¸°
# @name refresh
POST {{base}}/auth/refresh
Content-Type: {{json}}

{
  "refresh": "{{login.response.body.refresh}}"
}

### 2) ìœ ì € ê²€ìƒ‰ (ì±„íŒ… ëŒ€ìƒ ì°¾ê¸°)
# @name search_users
GET {{base}}/search/users?q={{q}}&limit=10
Authorization: Bearer {{refresh.response.body.access}}

### 2-ì˜µì…˜) í†µí•© ê²€ìƒ‰: @ë©˜ì…˜ìœ¼ë¡œ ë°”ë¡œ í›„ë³´ ì°¾ê¸°
# @name search_mention
GET {{base}}/search?q=@{{q}}
Authorization: Bearer {{refresh.response.body.access}}

### 3) DM ì—´ê¸°/ì¬ì‚¬ìš© (ìƒëŒ€: @other)
# @name open_dm
POST {{base}}/chats/dm/{{other}}
Authorization: Bearer {{refresh.response.body.access}}

### 4) DMì— ë©”ì‹œì§€ ë³´ë‚´ê¸°
# ìœ„ open_dm ì‘ë‹µì—ì„œ room id ì‚¬ìš© (ì˜ˆ: {{open_dm.response.body.id}})
# @name send_message
POST {{base}}/chats/{{open_dm.response.body.id}}/messages
Authorization: Bearer {{refresh.response.body.access}}
Content-Type: {{json}}

{
  "message": "ì±„íŒ… ê²€ìƒ‰ E2E í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ì…ë‹ˆë‹¤! ğŸ˜Š"
}

### 5) ë‚´ ì±„íŒ…ë°© ëª©ë¡ (ì „ì²´)
# @name list_chats
GET {{base}}/chats?limit=20
Authorization: Bearer {{refresh.response.body.access}}

### 5-ì˜µì…˜) DMë§Œ ëª©ë¡
# @name list_dm
GET {{base}}/chats/dm?limit=20
Authorization: Bearer {{refresh.response.body.access}}

### 6) ë°© ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬ ì¡°íšŒ (í˜ì´ì§€ë„¤ì´ì…˜)
# ì²˜ìŒ í˜ì´ì§€
# @name room_messages
GET {{base}}/chats/{{open_dm.response.body.id}}/messages?limit=30
Authorization: Bearer {{refresh.response.body.access}}

### 6-ì˜µì…˜) ë‹¤ìŒ í˜ì´ì§€ ì˜ˆì‹œ (ìœ„ ì‘ë‹µ next_cursor ê°’ìœ¼ë¡œ êµì²´)
# @name room_messages_next
GET {{base}}/chats/{{open_dm.response.body.id}}/messages?limit=30&cursor=__ì»¤ì„œê°’__
Authorization: Bearer {{refresh.response.body.access}}

### (ì˜µì…˜) ê·¸ë£¹ ì±„íŒ… ìƒì„± (ë‚˜ + 2ëª… ì´ìƒ)
# @name create_group
POST {{base}}/chats/groups
Authorization: Bearer {{refresh.response.body.access}}
Content-Type: {{json}}

{
  "title": "ë™ìŠ¤í† ë¦¬ í…ŒìŠ¤íŠ¸ ê·¸ë£¹ë°©",
  "user_ids": [42, 43]
}
